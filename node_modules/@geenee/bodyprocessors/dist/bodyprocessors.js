import{FaceTracker as X,PoseTracker as r}from'@geenee/bodytracking';import{Processor as t,Engine as w,VideoCapture as q}from'@geenee/armature';class E extends t{constructor(){super(...arguments),this['faceTracker']=new X(),this['cameraAngleBase']=0xa/0xb4*Math['PI'];}async['init'](L,v,D){return await this['faceTracker']['init'](L['token'],L['root'],L['cache'],L['highp']),await this['faceTracker']['prepare'](),super['init'](L,v,D);}['reset'](){this['faceTracker']['reset'](),super['reset']();}['dispose'](){this['faceTracker']['dispose']();}async['process'](L,v){return{'faces':(await this['faceTracker']['process'](L,v))['map'](D=>{const x=D&&this['params']['transform']?this['faceTracker']['align'](D['keypoints']):void 0x0,K=x&&this['params']['metric']?this['faceTracker']['metricPoints']():void 0x0,M=x&&this['params']['backproj']?this['faceTracker']['backprojPoints']():void 0x0;return{'mesh':D,'transform':x,'metric':K,'backproj':M};})};}['setupVideo'](L,v){super['setupVideo'](L,v),this['cameraAngle']=this['cameraRatio']>=0x1?this['cameraAngleBase']:0x2*Math['atan'](Math['tan'](0.5*this['cameraAngleBase'])/this['cameraRatio']),this['faceTracker']['setCamera'](this['cameraAngle'],this['cameraRatio'],0x1),this['faceTracker']['reset']();}}class N extends w{constructor(L,v=q){super(E,L,v);}}class O extends t{constructor(){super(),this['poseTracker']=new r(),this['cameraAngleBase']=0xf/0xb4*Math['PI'];const L=/iPhone|iPad|iPod/i['test'](navigator['userAgent']);this['optimalSize']=L?0x200:0x400;}async['init'](L,v,D){return await this['poseTracker']['init'](L['token'],L['root'],L['cache'],L['mask']),await this['poseTracker']['prepare'](),super['init'](L,v,D);}['reset'](){return this['poseTracker']['reset'](),super['reset']();}['dispose'](){this['poseTracker']['dispose']();}async['process'](L,v){return{'poses':(await this['poseTracker']['process'](L,v))['map'](D=>({'points':z['reduce']((x,K,M)=>(x[K]=D['keypoints'][M],x),{}),'score':D['score'],'mask':D['mask'],'debug':D['debug']}))};}['setupVideo'](L,v){super['setupVideo'](L,v),this['cameraAngle']=this['cameraRatio']>=0x1?this['cameraAngleBase']:0x2*Math['atan'](Math['tan'](0.5*this['cameraAngleBase'])/this['cameraRatio']),this['poseTracker']['setCamera'](this['cameraAngle'],this['cameraRatio'],0x1),this['poseTracker']['reset']();}}class c extends w{constructor(L,v=q){super(O,L,v);}}const z=['nose','eyeInnerL','eyeL','eyeOutterL','eyeInnerR','eyeR','eyeOutterR','earL','earR','mouthL','mouthR','shoulderL','shoulderR','elbowL','elbowR','wristL','wristR','pinkyL','pinkyR','indexL','indexR','thumbL','thumbR','hipL','hipR','kneeL','kneeR','ankleL','ankleR','heelL','heelR','footIndexL','footIndexR'];export{N as FaceEngine,E as FaceProcessor,c as PoseEngine,O as PoseProcessor};
